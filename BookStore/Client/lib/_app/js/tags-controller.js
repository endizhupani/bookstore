!function(){"use strict";function e(e){function t(t){var s=n.tags[t],o=decodeHtml(s.name);if(confirm("Are you sure you want to delete "+o+"? This tag will be removed from all the books associated with it.")){var i="/api/tags/?name="+window.encodeURIComponent(o);e.delete(i).then(function(){n.tags.splice(t,1),n.message="Tag deleted sucessfully",n.emptyMessage=a},function(e){n.errorMessage="Failed to delete tag"}).finally(function(){n.isBusy=!1})}else n.isBusy=!1}function a(){n.message=""}function s(){n.isBusy=!0,e.post("/api/tags",n.tag).then(function(){n.tags.push(n.tag),$window.location.href="#!/"},function(){n.errorMessage="Failed to add tag."}).finally(function(){n.isBusy=!1})}var n=this;n.tags=[],n.tag={},n.errorMessage="",n.message="",n.isBusy=!0,n.deleteTag=t,n.addTag=s,e.get("/api/tags").then(function(e){angular.copy(e.data,n.tags)},function(e){n.errorMessage="Failed to load data "+e}).finally(function(){n.isBusy=!1})}e.$inject=["$http"],angular.module("app-tags").controller("tagsController",e)}();